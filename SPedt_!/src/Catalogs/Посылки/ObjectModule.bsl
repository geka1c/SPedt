
Процедура ПередЗаписью(Отказ)
	Если Состав.Количество()	> 0 Тогда
		стрСостав	= Состав[0];
		Участник 	= стрСостав.Участник;
		Покупка  	= стрСостав.Покупка;
		Если ТипЗнч(стрСостав.Покупка)	<>	Тип("СправочникСсылка.Пристрой") и 
			 ТипЗнч(стрСостав.Покупка)	<>	Тип("СправочникСсылка.ЗаявкаНаДоставку")Тогда 
			Организатор 				= СП_РаботаСоСправочниками.ПолучитьОрганизатораПо_Коду(?(ТипЗнч(стрСостав.Покупка)=Тип("СправочникСсылка.Покупки"),стрСостав.Покупка.Владелец.Код,стрСостав.Покупка.Организатор.Код));
			НаименованиеПристрой			=	"";	
		ИначеЕсли ТипЗнч(стрСостав.Покупка)	=	Тип("СправочникСсылка.ЗаявкаНаДоставку") 	Тогда 	
			НаименованиеПристрой			=	" заявка на доставку";
		Иначе	
			НаименованиеПристрой			=	" пристрой";
		Конецесли;
	КонецЕсли;
	НаименованиеПосылки		= 	?(ЗначениеЗаполнено(Покупка),	Покупка.Наименование,"");
	
	Если ЗначениеЗаполнено(Покупка) Тогда
		Перезаполнить 		= Покупка.Догрузить;
		Догрузить			= Ложь;
	Иначе
		Перезаполнить 		= Истина;
		Догрузить			= Истина;
	КонецЕсли;	
	Наименование 			= "П ("+Формат(Код,"ЧГ=0")+") "+ НаименованиеПосылки;
КонецПроцедуры
